<!DOCTYPE html>
<html>
<head>
    <title>Hydroponics Monitor</title>
    <link rel="stylesheet" href="/static/style.css">
    <meta http-equiv="refresh" content="30">
</head>
<body>
    <h1>Hydroponics System Dashboard</h1>

    {% if data.get('timestamp') %}
        <p style="text-align: center; font-style: italic;">Last updated: {{ data['timestamp'] }}</p>
    {% endif %}

    <div class="container">
        <div class="video">
            <h2>Live Camera Feed</h2>
            <h3>Upper Garden</h3>
            <img src="{{ url_for('video_feed2') }}" width="480" />
            <h3>Lower Garden</h3>
            <img src="{{ url_for('video_feed1') }}" width="480" />
        </div>

        <div class="sensors">
            <h2>Sensor Readings</h2>
<ul>
    {% set temp = data.get('Air Temp', 'Disconnected') %}
    <li><strong>Air Temp:</strong>
        <span style='color: "{{ "gray" if temp == "Disconnected" else "red" if temp|float > 30 else "orange" if temp|float > 25 else "green" }}"'>{{ temp }}</span>
    </li>

    {% set temp = data.get('Water Temp Top', 'Disconnected') %}
    <li><strong>Water Temp (Top):</strong>
        <span style='color: "{{ "gray" if temp == "Disconnected" else "red" if temp|float > 30 else "orange" if temp|float > 25 else "green" }}"'>{{ temp }}</span>
    </li>

    {% set temp = data.get('Water Temp Bottom', 'Disconnected') %}
    <li><strong>Water Temp (Bottom):</strong>
        <span style='color: "{{ "gray" if temp == "Disconnected" else "red" if temp|float > 30 else "orange" if temp|float > 25 else "green" }}"'>{{ temp }}</span>
    </li>

    {% set ec = data.get('EC', 'Disconnected') %}
    <li><strong>EC:</strong>
        <span style='color: "{{ "gray" if ec == "Disconnected" else "red" if ec|float > 2 else "orange" if ec|float > 1.5 else "green" }}"'>{{ ec }}</span>
    </li>

    {% set ph = data.get('pH', 'Disconnected') %}
    <li><strong>pH:</strong>
        <span style='color: "{{ "gray" if ph == "Disconnected" else "red" if ph|float < 5.5 or ph|float > 7.5 else "orange" if 5.5 <= ph|float < 6.0 or 7.0 < ph|float <= 7.5 else "green" }}"'>{{ ph }}</span>
    </li>

    {% set top_float = data.get('Top Float', 'Disconnected') %}
    <li><strong>Top Float:</strong>
        <span style='color: "{{ "gray" if top_float == "Disconnected" else "red" if top_float == "Low" else "green" if top_float == "OK" else "black" }}"'>{{ top_float }}</span>
    </li>

    {% set bottom_float = data.get('Bottom Float', 'Disconnected') %}
    <li><strong>Bottom Float:</strong>
        <span style='color: "{{ "gray" if bottom_float == "Disconnected" else "red" if bottom_float == "Low" else "green" if bottom_float == "OK" else "black" }}"'>{{ bottom_float }}</span>
    </li>
</ul>

<h2>Relay Status</h2>
<ul>
    {% for relay in ['Top Light', 'Bottom Light', 'Top Pump', 'Bottom Pump'] %}
        {% set value = data.get('Relay ' + relay, 'Disconnected') %}
        <li><strong>{{ relay }}:</strong>
            <span style='color: "{{ "gray" if value == "Disconnected" else "red" if value == "Low" else "green" if value == "OK" else "black" }}"'>{{ value }}</span>
        </li>
    {% endfor %}
</ul>

<h2>Fan Status</h2>
<ul>
    {% for fan in ['Top Fan', 'Bottom Fan', 'Vent Fan', 'Circulation Fan'] %}
        {% set value = data.get('Relay ' + fan, 'Disconnected') %}
        <li><strong>{{ fan }}:</strong>
            <span style='color: "{{ "gray" if value == "Disconnected" else "red" if value == "Low" else "green" if value == "OK" else "black" }}"'>{{ value }}</span>
        </li>
    {% endfor %}
</ul>
        </div>
    </div>
</body>
</html>